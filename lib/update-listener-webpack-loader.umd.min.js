(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue")):"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["update-listener-webpack-loader"]=e(require("vue")):t["update-listener-webpack-loader"]=e(t["Vue"])})("undefined"!==typeof self?self:this,(function(t){return function(){"use strict";var e={203:function(e){e.exports=t}},n={};function o(t){var i=n[t];if(void 0!==i)return i.exports;var r=n[t]={exports:{}};return e[t](r,r.exports,o),r.exports}!function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.p=""}();var i={};return function(){if(o.r(i),o.d(i,{default:function(){return y}}),"undefined"!==typeof window){var t=window.document.currentScript,e=t&&t.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);e&&(o.p=e[1])}var n=o(203),r=o.n(n);function s(t,e,n){return(o,i=!0)=>new Promise(((s,c)=>{const a=r().extend(t),d=Object.assign({},e,o),l=new a({el:document.createElement("div"),propsData:d});l.$on("cancel",(function(t){this.$destroy();const e=this.$el.parentElement;e&&e.removeChild(this.$el),c(t)})),l.$on("confirm",(function(t){if(i){this.$destroy();const t=this.$el.parentElement;t&&t.removeChild(this.$el)}s(t,this)})),n||(n=document.body),n.appendChild(l.$el)}))}var c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"update-confirm"},[e("div",{staticClass:"update-confirm__wrapper"},[e("div",{staticClass:"update-confirm__header"},[e("div",{staticClass:"update-confirm__title"},[t._v("提示")]),e("div",{staticClass:"update-confirm__close",on:{click:t.cancel}},[t._v(" × ")])]),e("div",{staticClass:"update-confirm__content"},[e("div",{staticClass:"update-confirm__desc"},[t._v(t._s(t.content))])]),e("div",{staticClass:"update-confirm__btns"},[e("div",{staticClass:"update-confirm__btn update-confirm__btn--default",on:{click:t.cancel}},[t._v("取消")]),e("div",{staticClass:"update-confirm__btn update-confirm__btn--primary",on:{click:t.confirm}},[t._v("确定")])])])])},a=[],d={name:"UpdateConfirm",props:{content:{type:String,default:""}},methods:{cancel(){this.$emit("cancel")},confirm(){this.$emit("confirm")}}},l=d;function u(t,e,n,o,i,r,s,c){var a,d="function"===typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=n,d._compiled=!0),o&&(d.functional=!0),r&&(d._scopeId="data-v-"+r),s?(a=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},d._ssrRegister=a):i&&(a=c?function(){i.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:i),a)if(d.functional){d._injectStyles=a;var l=d.render;d.render=function(t,e){return a.call(e),l(t,e)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,a):[a]}return{exports:t,options:d}}var f=u(l,c,a,!1,null,"95a33740",null),p=f.exports;async function m(t,e){return s(p,t,e)()}const v={install(t,e){let n,o;const i=async()=>fetch(`${e.versionUrl||"/dist"}/version.json?timeStamp=`+Date.now()).then((t=>t.json())).catch((t=>{console.log(t)})),r=async()=>{const t=(await i()).commitHash;return t!==n},s=()=>{o&&(console.log("停止检查更新"),clearInterval(o),o="")},c=async()=>{if(!1===e.isTip)return;const t=await i();t&&(n=t.commitHash,t.isTip&&(console.log("开始检查更新"),o=setInterval((async()=>{const t=await r();t&&(console.log("有新版本"),s(),await a())}),e.interval||3e5)))},a=async()=>{try{const t=e.modalProps&&e.modalProps.content;await m({content:t?e.modalProps.content:"发现新版本，是否立即更新？"},e.modalProps&&e.modalProps.mountedEl),window.location.reload()}catch(t){console.log(t)}},d=()=>{document.hidden?s():c()};document.addEventListener("visibilitychange",d);const l=async t=>{"SCRIPT"===t.target.nodeName&&(s(),await a())};e.isListenJSError?window.addEventListener("error",l):window.removeEventListener("error",l),c()}};var _=v,h=_,y=h}(),i}()}));
//# sourceMappingURL=update-listener-webpack-loader.umd.min.js.map